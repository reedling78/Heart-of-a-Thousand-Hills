/*
 *  jQuery Image Grid - v1.0.0
 *  Just another Image Grid jQuery plugin
 *  
 *
 *  Made by Rabartu
 *  Under GPLv.3 License
 */
!function(a){null==a.isNumeric&&(a.isNumeric=function(a){return null!=a&&a.constructor===Number}),null==a.isFunction&&(a.isFunction=function(a){return null!=a&&a instanceof Function});var b=a(window),c=a(document),d={defaultConfig:{animate:!1,cellW:100,cellH:100,delay:0,engine:"giot",fixSize:null,gutterX:15,gutterY:15,keepOrder:!1,selector:"> div",draggable:!1,cacheSize:!0,rightToLeft:!1,bottomToTop:!1,onGapFound:function(){},onComplete:function(){},onResize:function(){},onBlockDrag:function(){},onBlockMove:function(){},onBlockDrop:function(){},onBlockReady:function(){},onBlockFinish:function(){},onBlockActive:function(){},onBlockResize:function(){}},plugin:{},totalGrid:1,transition:!1,loadBlock:function(b,c){var d=c.runtime,e=d.gutterX,f=d.gutterY,g=d.cellH,h=d.cellW,i=null,j=a(b),k=j.data("active"),l=j.attr("data-position"),m=parseInt(j.attr("data-fixSize")),n=d.lastId++ +"-"+d.totalGrid;if(!j.hasClass("fw-float")){j.attr({id:n,"data-delay":b.index}),c.animate&&this.transition&&this.setTransition(b,""),isNaN(m)&&(m=null),null==m&&(m=c.fixSize);var o=m>=1?"ceil":"round";null==j.attr("data-height")&&j.attr("data-height",j.height()),null==j.attr("data-width")&&j.attr("data-width",j.width());var p=1*j.attr("data-height"),q=1*j.attr("data-width");c.cacheSize||(b.style.width="",q=j.width(),b.style.height="",p=j.height());var r=q?Math[o]((q+e)/h):0,s=p?Math[o]((p+f)/g):0;if(m||"auto"!=c.cellH||(j.width(h*r-e),b.style.height="",p=j.height(),s=p?Math.round((p+f)/g):0),m||"auto"!=c.cellW||(j.height(g*s-f),b.style.width="",q=j.width(),r=q?Math.round((q+e)/h):0),null!=m&&(r>d.limitCol||s>d.limitRow))i=null;else if(s&&s<d.minHoB&&(d.minHoB=s),r&&r<d.minWoB&&(d.minWoB=r),s>d.maxHoB&&(d.maxHoB=s),r>d.maxWoB&&(d.maxWoB=r),0==q&&(r=0),0==p&&(s=0),i={resize:!1,id:n,width:r,height:s,fixSize:m},l){l=l.split("-"),i.y=1*l[0],i.x=1*l[1],i.width=null!=m?r:Math.min(r,d.limitCol-i.x),i.height=null!=m?s:Math.min(s,d.limitRow-i.y);var t=i.y+"-"+i.x+"-"+i.width+"-"+i.height;k?(d.holes[t]={id:i.id,top:i.y,left:i.x,width:i.width,height:i.height},this.setBlock(i,c)):delete d.holes[t]}return null==j.attr("data-state")?j.attr("data-state","init"):j.attr("data-state","move"),c.onBlockReady.call(b,i,c),l&&k?null:i}},setBlock:function(a,b){var c=b.runtime,d=c.gutterX,e=c.gutterY,f=a.height,g=a.width,h=c.cellH,i=c.cellW,j=a.x,k=a.y;b.rightToLeft&&(j=c.limitCol-j-g),b.bottomToTop&&(k=c.limitRow-k-f);var l={fixSize:a.fixSize,resize:a.resize,top:k*h,left:j*i,width:i*g-d,height:h*f-e};return l.top=1*l.top.toFixed(2),l.left=1*l.left.toFixed(2),l.width=1*l.width.toFixed(2),l.height=1*l.height.toFixed(2),a.id&&(c.blocks[a.id]=l),l},showBlock:function(b,c){function d(){if(i&&g.attr("data-state","start"),c.animate&&h.transition,f)f.fixSize&&(f.height=1*g.attr("data-height"),f.width=1*g.attr("data-width")),c.animate&&g.hasClass("imgrid-animated")?g.velocity({top:f.top,left:f.left,width:f.width,height:f.height,opacity:1},{duration:500,queue:!1,easing:"easeOutQuad"}):g.css({top:f.top,left:f.left,width:f.width,height:f.height,opacity:1}),null!=g.attr("data-nested")&&h.nestedGrid(b,c);else{var a=parseInt(b.style.height)||0,d=parseInt(b.style.width)||0,j=parseInt(b.style.left)||0,k=parseInt(b.style.top)||0;c.animate?g.velocity({left:j+d/2,top:k+a/2,width:0,height:0},{duration:500,queue:!1,easing:"easeOutQuad"}):g.css({left:j+d/2,top:k+a/2,width:0,height:0})}e.length-=1,c.onBlockFinish.call(b,f,c),0==e.length&&c.onComplete.call(b,f,c)}var e=c.runtime,f=(c.animate&&!this.transition?"animate":"css",e.blocks[b.id]),g=a(b),h=this,i="move"!=g.attr("data-state");b.delay&&clearTimeout(b.delay),g.hasClass("fw-float")||(h.setTransition(b,""),b.style.position="absolute",c.onBlockActive.call(b,f,c),f&&f.resize&&c.onBlockResize.call(b,f,c),c.delay>0?b.delay=setTimeout(d,c.delay*g.attr("data-delay")):d())},nestedGrid:function(b,c){var d,e=a(b),f=c.runtime,g=e.attr("data-gutterX")||c.gutterX,h=e.attr("data-gutterY")||c.gutterY,i=e.attr("data-method")||"fitZone",j=e.attr("data-nested")||"> div",k=e.attr("data-cellH")||c.cellH,l=e.attr("data-cellW")||c.cellW,m=f.blocks[b.id];if(m)switch(d=new freewall(e),d.reset({cellH:k,cellW:l,gutterX:1*g,gutterY:1*h,selector:j,cacheSize:!1}),i){case"fitHeight":d[i](m.height);break;case"fitWidth":d[i](m.width);break;case"fitZone":d[i](m.width,m.height)}},adjustBlock:function(b,c){var d=c.runtime,e=d.gutterX,f=d.gutterY,g=a("#"+b.id),h=d.cellH,i=d.cellW;"auto"==c.cellH&&(g.width(b.width*i-e),g[0].style.height="",b.height=Math.round((g.height()+f)/h))},adjustUnit:function(b,c,d){var e=d.gutterX,f=d.gutterY,g=d.runtime,h=d.cellW,i=d.cellH;if(a.isFunction(h)&&(h=h(b)),h=1*h,!a.isNumeric(h)&&(h=1),a.isFunction(i)&&(i=i(c)),i=1*i,!a.isNumeric(i)&&(i=1),a.isNumeric(b)){1>h&&(h*=b);var j=Math.max(1,Math.floor(b/h));a.isNumeric(e)||(e=(b-j*h)/Math.max(1,j-1),e=Math.max(0,e)),j=Math.floor((b+e)/h),g.cellW=(b+e)/Math.max(j,1),g.cellS=g.cellW/h,g.gutterX=e,g.limitCol=j}if(a.isNumeric(c)){1>i&&(i*=c);var k=Math.max(1,Math.floor(c/i));a.isNumeric(f)||(f=(c-k*i)/Math.max(1,k-1),f=Math.max(0,f)),k=Math.floor((c+f)/i),g.cellH=(c+f)/Math.max(k,1),g.cellS=g.cellH/i,g.gutterY=f,g.limitRow=k}a.isNumeric(b)||(1>h&&(h=g.cellH),g.cellW=1!=h?h*g.cellS:1,g.gutterX=e,g.limitCol=666666),a.isNumeric(c)||(1>i&&(i=g.cellW),g.cellH=1!=i?i*g.cellS:1,g.gutterY=f,g.limitRow=666666)},resetGrid:function(a){a.blocks={},a.length=0,a.cellH=0,a.cellW=0,a.lastId=1,a.matrix={},a.totalCol=0,a.totalRow=0},setDraggable:function(b,d){var e=!1,f={startX:0,startY:0,top:0,left:0,handle:null,onDrop:function(){},onDrag:function(){},onStart:function(){}};a(b).each(function(){function b(a){return a.stopPropagation(),a=a.originalEvent,a.touches&&(e=!0,a=a.changedTouches[0]),2!=a.button&&3!=a.which&&(i.onStart.call(k,a),i.startX=a.clientX,i.startY=a.clientY,i.top=parseInt(l.css("top"))||0,i.left=parseInt(l.css("left"))||0,c.bind("mouseup touchend",h),c.bind("mousemove touchmove",g)),!1}function g(a){a=a.originalEvent,e&&(a=a.changedTouches[0]),l.css({top:i.top-(i.startY-a.clientY),left:i.left-(i.startX-a.clientX)}),i.onDrag.call(k,a)}function h(a){a=a.originalEvent,e&&(a=a.changedTouches[0]),i.onDrop.call(k,a),c.unbind("mouseup touchend",h),c.unbind("mousemove touchmove",g)}var i=a.extend({},f,d),j=i.handle||this,k=this,l=a(k),m=a(j),n=l.css("position");"absolute"!=n&&l.css("position","relative"),l.find("iframe, form, input, textarea, .ignore-drag").each(function(){a(this).on("touchstart mousedown",function(a){a.stopPropagation()})}),c.unbind("mouseup touchend",h),c.unbind("mousemove touchmove",g),m.unbind("mousedown touchstart").bind("mousedown touchstart",b)})},setTransition:function(b,c){var d=b.style,e=a(b);!this.transition&&e.stop?e.stop():null!=d.webkitTransition?d.webkitTransition=c:null!=d.MozTransition?d.MozTransition=c:null!=d.msTransition?d.msTransition=c:null!=d.OTransition?d.OTransition=c:d.transition=c},getFreeArea:function(a,b,c){for(var d=Math.min(a+c.maxHoB,c.limitRow),e=Math.min(b+c.maxWoB,c.limitCol),f=e,g=d,h=c.matrix,i=a;g>i;++i)for(var j=b;e>j;++j)h[i+"-"+j]&&j>b&&f>j&&(f=j);for(var i=a;d>i;++i)for(var j=b;f>j;++j)h[i+"-"+j]&&i>a&&g>i&&(g=i);return{top:a,left:b,width:f-b,height:g-a}},setWallSize:function(a,b){var c=a.totalRow,d=a.totalCol,e=a.gutterY,f=a.gutterX,g=a.cellH,h=a.cellW,i=Math.max(0,h*d-f),j=Math.max(0,g*c-e);b.attr({"data-total-col":d,"data-total-row":c,"data-wall-width":Math.ceil(i),"data-wall-height":Math.ceil(j)}),a.limitCol<a.limitRow&&(!b.attr("data-height")&&Math.ceil(j),b.velocity({height:Math.ceil(j)},{duration:500,queue:!1,easing:"easeOutQuad"}))}},e={giot:function(a,b){function c(a,b,c,d,e){for(var f=b;b+e>f;){for(var g=c;c+d>g;)o[f+"-"+g]=a,++g>j&&(j=g);++f>k&&(k=f)}}var e=b.runtime,f=e.limitRow,g=e.limitCol,h=0,i=0,j=e.totalCol,k=e.totalRow,l={},m=e.holes,n=null,o=e.matrix,p=Math.max(g,f),q=null,r=null,s=f>g?1:0,t=null,u=Math.min(g,f);for(var v in m)m.hasOwnProperty(v)&&c(m[v].id||!0,m[v].top,m[v].left,m[v].width,m[v].height);for(var w=0;p>w&&a.length;++w){s?i=w:h=w,t=null;for(var x=0;u>x&&a.length;++x)if(n=null,s?h=x:i=x,!e.matrix[i+"-"+h]){if(q=d.getFreeArea(i,h,e),null==b.fixSize){if(t&&!s&&e.minHoB>q.height){t.height+=q.height,t.resize=!0,c(t.id,t.y,t.x,t.width,t.height),d.setBlock(t,b);continue}if(t&&s&&e.minWoB>q.width){t.width+=q.width,t.resize=!0,c(t.id,t.y,t.x,t.width,t.height),d.setBlock(t,b);continue}}if(b.keepOrder)n=a.shift(),n.resize=!0;else{for(var v=0;v<a.length;++v)if(!(a[v].height>q.height||a[v].width>q.width)){n=a.splice(v,1)[0];break}if(null==n&&null==b.fixSize)for(var v=0;v<a.length;++v)if(null==a[v].fixSize){n=a.splice(v,1)[0],n.resize=!0;break}}if(null!=n)n.resize&&(s?(n.width=q.width,"auto"==b.cellH&&d.adjustBlock(n,b),n.height=Math.min(n.height,q.height)):(n.height=q.height,n.width=Math.min(n.width,q.width))),l[n.id]={id:n.id,x:h,y:i,width:n.width,height:n.height,resize:n.resize,fixSize:n.fixSize},t=l[n.id],c(t.id,t.y,t.x,t.width,t.height),d.setBlock(t,b);else{var r={x:h,y:i,fixSize:0};if(s){r.width=q.width,r.height=0;for(var y=h-1,z=i;o[z+"-"+y];)o[z+"-"+h]=!0,r.height+=1,z+=1}else{r.height=q.height,r.width=0;for(var z=i-1,y=h;o[z+"-"+y];)o[i+"-"+y]=!0,r.width+=1,y+=1}b.onGapFound(d.setBlock(r,b),b)}}}e.matrix=o,e.totalRow=k,e.totalCol=j}};window.freewall=function(c){function f(b){var c=(k.gutterX,k.gutterY,k.cellH),e=k.cellW,f=a(b),g=f.find(f.attr("data-handle"));d.setDraggable(b,{handle:g[0],onStart:function(a){j.animate&&d.transition&&d.setTransition(this,""),f.css("z-index",9999).addClass("fw-float"),j.onBlockDrag.call(b,a)},onDrag:function(a){var d=f.position(),g=Math.round(d.top/c),h=Math.round(d.left/e),l=Math.round(f.width()/e),m=Math.round(f.height()/c);g=Math.min(Math.max(0,g),k.limitRow-m),h=Math.min(Math.max(0,h),k.limitCol-l),i.setHoles({top:g,left:h,width:l,height:m}),i.refresh(),j.onBlockMove.call(b,a)},onDrop:function(d){var g=f.position(),h=Math.round(g.top/c),l=Math.round(g.left/e),m=Math.round(f.width()/e),n=Math.round(f.height()/c);h=Math.min(Math.max(0,h),k.limitRow-n),l=Math.min(Math.max(0,l),k.limitCol-m),f.removeClass("fw-float"),f.css({zIndex:"auto",top:h*c,left:l*e});var o,p,q,r;for(p=0;n>p;++p)for(o=0;m>o;++o)q=p+h+"-"+(o+l),r=k.matrix[q],r&&1!=r&&a("#"+r).removeAttr("data-position");k.holes={},f.attr({"data-width":f.width(),"data-height":f.height(),"data-position":h+"-"+l}),i.refresh(),j.onBlockDrop.call(b,d)}})}var g=a(c);"static"==g.css("position")&&g.css("position","relative");var h=Number.MAX_VALUE,i=this;d.totalGrid+=1;var j=a.extend({},d.defaultConfig),k={blocks:{},events:{},matrix:{},holes:{},cellW:0,cellH:0,cellS:1,filter:"",lastId:0,length:0,maxWoB:0,maxHoB:0,minWoB:h,minHoB:h,running:0,gutterX:15,gutterY:15,totalCol:0,totalRow:0,limitCol:666666,limitRow:666666,currentMethod:null,currentArguments:[]};j.runtime=k,k.totalGrid=d.totalGrid;var l=document.body.style;d.transition||(null!=l.webkitTransition||null!=l.MozTransition||null!=l.msTransition||null!=l.OTransition||null!=l.transition)&&(d.transition=!0),a.extend(i,{addCustomEvent:function(a,b){var c=k.events;return a=a.toLowerCase(),!c[a]&&(c[a]=[]),b.eid=c[a].length,c[a].push(b),this},appendBlock:function(b){var c=a(b).appendTo(g),h=null,i=[];k.currentMethod&&(c.each(function(a,b){b.index=++a,h=d.loadBlock(b,j),h&&i.push(h)}),e[j.engine](i,j),d.setWallSize(k,g),k.length=c.length,c.each(function(a,b){d.showBlock(b,j),(j.draggable||b.getAttribute("data-draggable"))&&f(b)}))},appendHoles:function(a){var b,c=[].concat(a),d={};for(b=0;b<c.length;++b)d=c[b],k.holes[d.top+"-"+d.left+"-"+d.width+"-"+d.height]=d;return this},container:g,destroy:function(){var b=g.find(j.selector).removeAttr("id");b.each(function(b,c){$item=a(c);var d=1*$item.attr("data-width")||"",e=1*$item.attr("data-height")||"";$item.width(d).height(e).css({position:"static"})})},fillHoles:function(a){if(0==arguments.length)k.holes={};else{var b,c=[].concat(a),d={};for(b=0;b<c.length;++b)d=c[b],delete k.holes[d.top+"-"+d.left+"-"+d.width+"-"+d.height]}return this},filter:function(a){return k.filter=a,k.currentMethod&&this.refresh(),this},fireEvent:function(a,b,c){var d=k.events;if(a=a.toLowerCase(),d[a]&&d[a].length)for(var e=0;e<d[a].length;++e)d[a][e].call(this,b,c);return this},fitHeight:function(c){var h=g.find(j.selector).removeAttr("id"),l=null,m=[];c=c?c:g.height()||b.height(),k.currentMethod=arguments.callee,k.currentArguments=arguments,d.resetGrid(k),d.adjustUnit("auto",c,j),k.filter?(h.data("active",0),h.filter(k.filter).data("active",1)):h.data("active",1),h.each(function(b,c){var e=a(c);c.index=++b,l=d.loadBlock(c,j),l&&e.data("active")&&m.push(l)}),i.fireEvent("onGridReady",g,j),e[j.engine](m,j),d.setWallSize(k,g),i.fireEvent("onGridArrange",g,j),k.length=h.length,h.each(function(a,b){d.showBlock(b,j),(j.draggable||b.getAttribute("data-draggable"))&&f(b)})},fitWidth:function(c){var h=g.find(j.selector).removeAttr("id"),l=null,m=[];c=c?c:g.width()||b.width(),k.currentMethod=arguments.callee,k.currentArguments=arguments,d.resetGrid(k),d.adjustUnit(c,"auto",j),k.filter?(h.data("active",0),h.filter(k.filter).data("active",1)):h.data("active",1),h.each(function(b,c){var e=a(c);c.index=++b,l=d.loadBlock(c,j),l&&e.data("active")&&m.push(l)}),i.fireEvent("onGridReady",g,j),e[j.engine](m,j),d.setWallSize(k,g),i.fireEvent("onGridArrange",g,j),k.length=h.length,h.each(function(a,b){d.showBlock(b,j),(j.draggable||b.getAttribute("data-draggable"))&&f(b)})},fitZone:function(c,h){var l=g.find(j.selector).removeAttr("id"),m=null,n=[];h=h?h:g.height()||b.height(),c=c?c:g.width()||b.width(),k.currentMethod=arguments.callee,k.currentArguments=arguments,d.resetGrid(k),d.adjustUnit(c,h,j),k.filter?(l.data("active",0),l.filter(k.filter).data("active",1)):l.data("active",1),l.each(function(b,c){var e=a(c);c.index=++b,m=d.loadBlock(c,j),m&&e.data("active")&&n.push(m)}),i.fireEvent("onGridReady",g,j),e[j.engine](n,j),d.setWallSize(k,g),i.fireEvent("onGridArrange",g,j),k.length=l.length,l.each(function(a,b){d.showBlock(b,j),(j.draggable||b.getAttribute("data-draggable"))&&f(b)})},fixPos:function(b){return a(b.block).attr({"data-position":b.top+"-"+b.left}),this},fixSize:function(b){return null!=b.height&&a(b.block).attr({"data-height":b.height}),null!=b.width&&a(b.block).attr({"data-width":b.width}),this},prepend:function(a){return g.prepend(a),k.currentMethod&&this.refresh(),this},refresh:function(){var a=arguments.length?arguments:k.currentArguments;return null==k.currentMethod&&(k.currentMethod=this.fitWidth),k.currentMethod.apply(this,Array.prototype.slice.call(a,0)),this},reset:function(b){return a.extend(j,b),this},setHoles:function(a){var b,c=[].concat(a),d={};for(k.holes={},b=0;b<c.length;++b)d=c[b],k.holes[d.top+"-"+d.left+"-"+d.width+"-"+d.height]=d;return this},unFilter:function(){return delete k.filter,this.refresh(),this}}),g.attr("data-min-width",80*Math.floor(b.width()/80));for(var m in d.plugin)d.plugin.hasOwnProperty(m)&&d.plugin[m].call(i,j,g);b.resize(function(){k.running||(k.running=1,setTimeout(function(){k.running=0,j.onResize.call(i,g)},122),g.attr("data-min-width",80*Math.floor(b.width()/80)))})},freewall.addConfig=function(b){a.extend(d.defaultConfig,b)},freewall.createEngine=function(b){a.extend(e,b)},freewall.createPlugin=function(b){a.extend(d.plugin,b)},freewall.getMethod=function(a){return d[a]}}(window.Zepto||window.jQuery),function(a,b,c,d){function e(b,c){this.element=b,this.e_original=a(b).clone(),this.options=a.extend({},q,c),this._defaults=q,this._name=p,this.wall={},this.addedCount=0,this.loader={},this.rowsTops=[],this.rowIndex=0,this.thumbIndex=0,this.loaded=!1,this.filtered=!1,this.init()}function f(b,c){var d=0;if("auto"===c.thumbSize){if(b.find("figure img").each(function(){("square"===c.gridLayout||"masonry"===c.gridLayout)&&(d>parseInt(a(this).css("width"),10)||0===d)&&(d=parseInt(a(this).css("width"),10),d>b.width()&&(d=b.width()/2)),("square"===c.gridLayout||"fluid"===c.gridLayout)&&(d>parseInt(a(this).css("height"),10)||0===d)&&(d=parseInt(a(this).css("height"),10),d>b.height()&&(d=b.height()/2))}),"fit"===c.gridLayout){var e=b.find("figure").length;d=Math.round(1.18*Math.sqrt(parseInt(b.css("width"),10)*parseInt(b.css("height"),10)/e))}}else d=c.thumbSize;return d}function g(b,c){"string"==typeof b.options.gridLoader?b.loader=a(b.options.gridLoader):b.options.gridLoader&&(b.loader=a('<div class="imgrid-loader"><span class="imgrid-loader-block"></span><span class="imgrid-loader-block"></span><span class="imgrid-loader-block"></span><span class="imgrid-loader-block"></span><span class="imgrid-loader-block"></span><span class="imgrid-loader-block"></span><span class="imgrid-loader-block"></span><span class="imgrid-loader-block"></span><span class="imgrid-loader-block"></span></div>')),"top"===c&&b.loader.insertBefore(a(b.element)),"bottom"===c&&b.loader.insertAfter(a(b.element))}function h(a){a.loader.remove()}function i(b,c,d,e){var g;switch(c.thumbBackground&&b.css("background",c.thumbBackground),c.thumbReziseImg&&b.find("img").css("width"," -webkit-calc(100%)").css("width","calc(100%)"),c.gridLayout){case"square":b.each(function(){g=a(this).find("img"),g.data("original-width",g.width()).data("original-height",g.height()),a(this).css("width",d+"px").css("height",d+"px")});break;case"fluid":b.each(function(){g=a(this).find("img"),g.data("original-width",g.width()).data("original-height",g.height());var b=parseInt(g.css("width"),10)/parseInt(g.css("height"),10);a(this).css("width",d*b+"px").css("height",d+"px")});break;case"masonry":b.each(function(){g=a(this).find("img"),g.data("original-width",g.width()).data("original-height",g.height());var b=parseInt(g.css("width"),10)/parseInt(g.css("height"),10);a(this).css("width",d+"px").css("height",d/b+"px")});break;case"fit":var h=f(e,c),i=c.thumbMargin/2;b.each(function(){g=a(this).find("img"),g.data("original-width",g.width()).data("original-height",g.height());var b,c=parseInt(g.css("width"),10),d=parseInt(g.css("height"),10);c>d?(b=d/c,a(this).css("width",h-i+"px").css("height",h*b-i+"px")):(b=c/d,a(this).css("width",h*b-i+"px").css("height",h-i+"px"))})}return b}function j(a,b){var c=f(a,b),d=a.find("figure");a.addClass("imgrid"),b.gridAnimation&&a.css("opacity",0),d.hasClass("imgrid-thumbnail")||(d.addClass("imgrid-thumbnail effect-"+b.thumbHoverEffect),b.gridAnimation===!1?d.addClass("imgrid-animated"):d.css("opacity",0)),i(d,b,c,a)}function k(c,d){(d.gridAnimation||"onScroll"===d.gridAnimation.trigger)&&(c._onScroll(),a(b).on("scroll",function(){c._onScroll()}))}function l(b){var c;b.options.gridAnimation===!1&&(b.loaded=!0,h(b),c=a.Event("imgrid.loaded"),a(b.element).trigger(c)),c=a.Event("imgrid.ready"),a(b.element).trigger(c),c.isDefaultPrevented()||b.resizeCaption({maxFontSize:3,widthToHide:150})}function m(b){b.loaded=!0,a(b.element).css("opacity",""),h(b),k(b,b.options);var c=a.Event("imgrid.loaded");a(b.element).trigger(c)}function n(b,c,d){if(d.gridAnimation!==!1){var e,f=a(b.element).find("figure").length,g={duration:d.gridAnimation.animationDuration};if(b.thumbIndex=b.thumbIndex+1,b.loaded){if(0!==b.addedCount&&b.addedCount===b.thumbIndex){var h=a(b.element).find("figure:not(.imgrid-animated)");d.gridAnimation.delay&&(e=parseInt(d.gridAnimation.animationDuration/h.length,10),g={stagger:e,drag:!0,duration:d.gridAnimation.animationDuration}),h.css("display","none"),setTimeout(function(){h.velocity("transition."+d.gridAnimation.animationType+"In",g).delay(d.gridAnimation.timeout+d.gridAnimation.animationDuration).addClass("imgrid-animated"),b.wall.filter(b.filtered),b.addedCount=0,b.thumbIndex=0,m(b)},500)}b.thumbIndex===f&&(b.thumbIndex=0)}else if(-1===a.inArray(c.top,b.rowsTops)&&b.rowsTops.push(parseInt(c.top,10)),f===b.thumbIndex){if("onScroll"===d.gridAnimation.trigger&&a(b.element).find("figure:not(.imgrid-animated)").each(function(){var c=a.inArray(parseInt(a(this).css("top"),10),b.rowsTops);-1!==c&&a(this).addClass("imgrid-row-"+c),a(this).css("display","none")}),"onStart"===d.gridAnimation.trigger){var i=a(b.element).find("figure:not(.imgrid-animated)");d.gridAnimation.delay&&(e=parseInt(d.gridAnimation.animationDuration/(i.length/4),10),g={stagger:e,drag:!0,duration:d.gridAnimation.animationDuration}),i.css("display","none"),setTimeout(function(){i.velocity("transition."+d.gridAnimation.animationType+"In",g).delay(d.gridAnimation.timeout+d.gridAnimation.animationDuration).addClass("imgrid-animated")},500)}b.thumbIndex=0,m(b)}}}function o(d,e){function f(b){i=!1,a("#imgrid-lightbox-overlay").fadeOut(k,function(){h=!1,a(this).remove()}),b.velocity({width:b.data("width"),height:b.data("height"),left:b.data("left"),top:b.data("top")},{duration:k,queue:!1,easing:"easeOutQuad",complete:function(){g.css("top","").css("color","").css("font-weight",m.fontWeight).css("font-size",m.fontSize),g.find("h2").css("display",m.displayH),g.find(".description").css("display",m.displayD),b.css({"z-index":"","box-shadow":"none",overflow:"hidden"}).addClass("effect-"+e.thumbHoverEffect),b.find("img").css("opacity",""),b.removeClass("active"),i=!0}})}var g,h=!1,i=!0,j=275,k=200,l={},m={};a(d.element).on("click","figure",function(){if(l=a(this),i===!1)return!1;if(h&&i===!0)return f(l),!1;g=l.find("figcaption");var d=b.innerWidth,k=b.innerHeight,n=l.width(),o=l.height(),p=l.find("img").data("original-width"),q=l.find("img").data("original-height");m={top:g.css("top"),color:g.css("color"),fontWeight:g.css("font-weight"),fontSize:g.css("font-size"),displayH:g.find("h2").css("display"),displayD:g.find(".description").css("display")};var r=l.css("top"),s=l.css("left");i=!1,l.addClass("active"),h=!0,l.css({"z-index":1e3}).data("width",n).data("height",o).data("top",r).data("left",s);var t=a('<div id="imgrid-lightbox-overlay"></div>').css({opacity:0}).click(function(){i===!0&&f(l)});a("body").append(t),t.velocity({opacity:.75},{duration:j,queue:!1,easing:"easeOutQuad"});var u=0,v=p/d,w=q/k,x=0,y=0;v>w?(u=q/p,x=.8*d,y=.8*d*u):(u=p/q,x=.8*k*u,y=.8*k),l.css("left",s).css("top",r).css("box-shadow","0px 16px 28px 0px rgba(0, 0, 0, 0.22), 0px 25px 55px 0px rgba(0, 0, 0, 0.21)").css("overflow","visible").removeClass("effect-"+e.thumbHoverEffect).velocity({left:a(c).scrollLeft()+d/2-l.parent(".imgrid").offset().left-x/2,top:a(c).scrollTop()+k/2-l.parent(".imgrid").offset().top-y/2,height:y,width:x},{duration:j,queue:!1,easing:"easeOutQuad",complete:function(){a(this).find("img").css("opacity",1),g.css("top",y-25+"px").css("color","#bebec0").css("font-weight",600).css("font-size","16px"),g.find("h2").css("display","block"),g.find(".description").css("display","block"),i=!0}})}),a(b).scroll(function(){h&&f(l)}),a(c).keyup(function(a){27===a.keyCode&&i===!0&&h&&f(l)})}var p="imgrid",q={gridLayout:"square",gridLoader:!0,gridAnimation:{trigger:"onStart",animationType:"fade",animationDuration:1e3,delay:!0,offsetTop:250,timeout:0},thumbSize:"auto",thumbMargin:0,thumbCacheSize:!0,thumbHoverEffect:"lily",thumbBackground:null,thumbReziseImg:!0,thumbAnimation:!0,thumbLightbox:!0};e.prototype._onScroll=function(){var c=a(b),d=c.height(),e=c.scrollTop(),f=a(this.element),g=this,h=this.options,i=f.find("figure:not(.imgrid-animated)");if(e+d-h.gridAnimation.offsetTop>f.offset().top+g.rowsTops[g.rowIndex]){i=f.find("figure.imgrid-row-"+g.rowIndex+":not(.imgrid-animated)");var j={duration:h.gridAnimation.animationDuration};if(h.gridAnimation.delay){var k=parseInt(h.gridAnimation.animationDuration/i.length,10);j={stagger:k,drag:!0,duration:h.gridAnimation.animationDuration}}i.velocity("transition."+h.gridAnimation.animationType+"In",j).delay(h.gridAnimation.timeout).addClass("imgrid-animated"),g.rowIndex=g.rowIndex+1}};var r={square:function(b,c){b.wall=new freewall(b.element);var d=f(a(b.element),c),e=d;b.wall.reset({selector:".imgrid-thumbnail",keepOrder:!1,animate:c.thumbAnimation,cellW:function(a){return e=a,a>d?d:a},cellH:function(){return e>d?d:e},gutterX:c.thumbMargin,gutterY:c.thumbMargin,delay:0,onResize:function(){b.wall.refresh()},onComplete:l(b),onBlockFinish:function(a){n(b,a,c)}}),b.wall.fitWidth()},fluid:function(b,c){b.wall=new freewall(b.element);var d=f(a(b.element),c);b.wall.reset({selector:".imgrid-thumbnail",keepOrder:!1,animate:c.thumbAnimation,cellW:20,cellH:d,gutterX:c.thumbMargin,gutterY:c.thumbMargin,delay:0,onResize:function(){b.wall.refresh()},onComplete:l(b),onBlockFinish:function(a){n(b,a,c)}}),b.wall.fitWidth()},masonry:function(b,c){b.wall=new freewall(b.element);var d=f(a(b.element),c);b.wall.reset({selector:".imgrid-thumbnail",keepOrder:!1,animate:c.thumbAnimation,cellW:d,cellH:"auto",gutterX:c.thumbMargin,gutterY:c.thumbMargin,delay:50,onResize:function(){b.wall.refresh()},onComplete:l(b),onBlockFinish:function(a){n(b,a,c)}}),b.wall.fitWidth()},fit:function(b,c){b.wall=new freewall(b.element);var d=f(a(b.element),c);b.wall.reset({selector:".imgrid-thumbnail",animate:c.thumbAnimation,cellW:d/2,cellH:d/2,gutterX:c.thumbMargin,gutterY:c.thumbMargin,delay:0,onResize:function(){b.wall.refresh(parseInt(a(b.element).css("width"),10),parseInt(a(b.element).css("height"),10))},onComplete:l(b),onBlockFinish:function(a){n(b,a,c)}}),b.wall.fitZone(parseInt(a(b.element).css("width"),10),parseInt(a(b.element).css("height"),10))}};e.prototype.init=function(){var b=this;g(b,"top"),a(b.element).imagesLoaded(function(){j(a(b.element),b.options),r[b.options.gridLayout](b,b.options),b.options.thumbLightbox&&o(b,b.options)})},e.prototype.filter=function(a){a&&"all"!==a?(this.filtered="."+a,this.wall.filter("."+a)):(this.wall.unFilter(),this.filtered=!1)},e.prototype.addMore=function(b){var c=this,d=.9*f(a(c.element),c.options),e=a("<div/>").html(b).css("opacity",0).appendTo("body"),h=e.find("figure");h.hasClass("imgrid-thumbnail")||(h.addClass("imgrid-thumbnail effect-"+c.options.thumbHoverEffect),c.options.gridAnimation===!1&&h.addClass("imgrid-animated")),i(h,c.options,d,a(c.element)),g(c,"bottom"),e.imagesLoaded(function(){var b=h.length;c.addedCount=b,h.each(function(d,f){var g=a(f).find("img");g.attr("data-original-width",g.width()).attr("data-original-height",g.height()),c.wall.appendBlock(this.outerHTML),d===b-1&&(e.remove(),c.options.gridAnimation===!1&&c.wall.filter(c.filtered),l(c))})})},e.prototype.resizeCaption=function(b){var c=b.maxFontSize,d=b.widthToHide,e=this,g=c/a(e.element).width();a(e.element).find("figure figcaption").each(function(){var b=f(a(e.element),e.options);d>b?(a(this).find("h2").css("display","none"),a(this).find("p").css("display","none")):(a(this).css("font-size",b*g+"em"),a(this).find("h2").css("display",""),a(this).find("p").css("display",""))})},e.prototype.hoverEffect=function(b){var c=this;return b?(a(c.element).find("figure").removeClass("effect-"+c.options.thumbHoverEffect).addClass("effect-"+b),void(c.options.thumbHoverEffect=b)):c.options.thumbHoverEffect},e.prototype.isLoaded=function(){return this.loaded===!0&&0===this.addedCount},e.prototype.destroy=function(){this.wall={},a(this.e_original).insertBefore(a(this.element)),a(this.element).remove()},a.fn[p]=function(b){var c=arguments;if(b===d||"object"==typeof b)return this.each(function(){a.data(this,"plugin_"+p)||a.data(this,"plugin_"+p,new e(this,b))});if("string"==typeof b&&"_"!==b[0]&&"init"!==b){var f;return this.each(function(){var d=a.data(this,"plugin_"+p);d instanceof e&&"function"==typeof d[b]&&(f=d[b].apply(d,Array.prototype.slice.call(c,1))),"destroy"===b&&a.data(this,"plugin_"+p,null)}),f!==d?f:this}}}(jQuery,window,document);